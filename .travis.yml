language: cpp

env:
  - GPM=true
  - GPM=false
os:
  - linux
  - osx
#  - windows

# Linux config
dist: focal

# macOS config
osx_image: xcode12  
addons:
  homebrew:
    packages:
    - ncurses

compiler:
  - clang
  - gcc

jobs:
  include:
    - os: linux
      env:
        - GPM2=true
        - GPM2=false
  exclude:
    - os: osx
      compiler: gcc
    - os: osx
      env: GPM=true

before_install:
  - if [[ "$GPM" == "true" ]]; then
      if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then
        sudo apt-get -y install libgpm-dev;
      fi
    fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then
      brew update ;
      brew install ncurses ;
      brew link --force qt ;
    fi

script:
  - cmake .
  - cmake --build .

after_success:
  - ls -l bin lib
